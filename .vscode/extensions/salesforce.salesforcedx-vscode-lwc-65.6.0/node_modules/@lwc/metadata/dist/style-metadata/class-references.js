'use strict';

var postcssSelector = require('postcss-selector-parser');
var utils = require('../shared/utils.js');
var utils$1 = require('./utils.js');

function _interopDefaultCompat (e) { return e && typeof e === 'object' && 'default' in e ? e : { default: e }; }

var postcssSelector__default = /*#__PURE__*/_interopDefaultCompat(postcssSelector);

// Copyright (c) 2025, Salesforce, Inc.,
// All rights reserved.
// For full license text, see the LICENSE.txt file
const createClassReference = (className) => ({
    name: className,
    locations: [],
});
function collectClassReferences(result, root) {
    const classMap = new Map();
    root.walkRules((rule) => {
        const { selector, source } = rule;
        const processor = postcssSelector__default.default();
        const parsedSelector = processor.astSync(selector, { lossless: true });
        parsedSelector.walkClasses((node) => {
            const { value: className, sourceIndex } = node;
            let classReference = classMap.get(className);
            if (utils.isUndefined(classReference)) {
                classReference = createClassReference(className);
                classMap.set(className, classReference);
            }
            classReference.locations.push(utils$1.getReferenceLocation(source, source.start.offset + sourceIndex, className.length));
        });
    });
    result.classReferences.push(...classMap.values());
}

exports.collectClassReferences = collectClassReferences;
//# sourceMappingURL=class-references.js.map
